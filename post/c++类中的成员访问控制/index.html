<!DOCTYPE html>
<html lang="en-us">
<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">

    
    <meta property="og:site_name" content="Huimin Blog">
    <meta property="og:type" content="article">

    
    <meta property="og:image" content="https://lianghm.top//img/home-bg-jeep.jpg">
    <meta property="twitter:image" content="https://lianghm.top//img/home-bg-jeep.jpg" />
    

    
    <meta name="title" content="C&#43;&#43;类中的成员访问控制" />
    <meta property="og:title" content="C&#43;&#43;类中的成员访问控制" />
    <meta property="twitter:title" content="C&#43;&#43;类中的成员访问控制" />
    

    
    <meta name="description" content="">
    <meta property="og:description" content="" />
    <meta property="twitter:description" content="" />
    

    
    <meta property="twitter:card" content="summary" />
    
    

    <meta name="keyword"  content="">
    <link rel="shortcut icon" href="/img/favicon.ico">

    <title>C&#43;&#43;类中的成员访问控制-</title>

    <link rel="canonical" href="/post/c&#43;&#43;%E7%B1%BB%E4%B8%AD%E7%9A%84%E6%88%90%E5%91%98%E8%AE%BF%E9%97%AE%E6%8E%A7%E5%88%B6/">

    <link rel="stylesheet" href="/css/iDisqus.min.css"/>

    
    <link rel="stylesheet" href="/css/bootstrap.min.css">

    
    <link rel="stylesheet" href="/css/hux-blog.min.css">

    
    <link rel="stylesheet" href="/css/zanshang.css">

    
    <link href="//cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.1/css/all.min.css" rel="stylesheet" type="text/css">

    
    

    
    
    <script src="/js/jquery.min.js"></script>

    
    <script src="/js/bootstrap.min.js"></script>

    
    <script src="/js/hux-blog.min.js"></script>

    
    

</head>



<nav class="navbar navbar-default navbar-custom navbar-fixed-top">
    <div class="container-fluid">
        
        <div class="navbar-header page-scroll">
            <button type="button" class="navbar-toggle">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
            </button>
            <a class="navbar-brand" href="/">Huimin Blog</a>
        </div>

        
        
        <div id="huxblog_navbar">
            <div class="navbar-collapse">
                <ul class="nav navbar-nav navbar-right">
                    <li>
                        <a href="/">Home</a>
                    </li>
                    
                        
                        <li>
                            <a href="/categories/tech">tech</a>
                        </li>
                        
                    
                    
		    

                    
                </ul>
            </div>
        </div>
        
    </div>
    
</nav>
<script>
    
    
    
    var $body   = document.body;
    var $toggle = document.querySelector('.navbar-toggle');
    var $navbar = document.querySelector('#huxblog_navbar');
    var $collapse = document.querySelector('.navbar-collapse');

    $toggle.addEventListener('click', handleMagic)
    function handleMagic(e){
        if ($navbar.className.indexOf('in') > 0) {
        
            $navbar.className = " ";
            
            setTimeout(function(){
                
                if($navbar.className.indexOf('in') < 0) {
                    $collapse.style.height = "0px"
                }
            },400)
        }else{
        
            $collapse.style.height = "auto"
            $navbar.className += " in";
        }
    }
</script>




<style type="text/css">
    header.intro-header {
        background-image: url('/img/home-bg-jeep.jpg')
    }
</style>
<header class="intro-header">
    <div class="container">
        <div class="row">
            <div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1">
                <div class="post-heading">
                    <div class="tags">
                        
                        <a class="tag" href="/tags/c&#43;&#43;" title="C&#43;&#43;">
                            C&#43;&#43;
                        </a>
                        
                    </div>
                    <h1>C&#43;&#43;类中的成员访问控制</h1>
                    <h2 class="subheading"></h2>
                    <span class="meta">
                        Posted by 
                        
                            Liang Huimin
                         
                        on 
                        Wednesday, November 6, 2019
                        
                        
                        
                    </span>
                </div>
            </div>
        </div>
    </div>
</header>




<article>
    <div class="container">
        <div class="row">

            
            <div class="
                col-lg-11 col-lg-offset-1
                col-md-10 col-md-offset-1
                post-container">

                
                <header>
                    <h2>TOC</h2>
                </header>
                <nav id="TableOfContents">
  <ul>
    <li><a href="#c类中的成员访问控制">C++类中的成员访问控制</a>
      <ul>
        <li><a href="#access-control-in-derived-classes">Access Control in Derived Classes</a></li>
        <li><a href="#access-control-and-static-members">Access control and static members</a></li>
        <li><a href="#access-to-virtual-functions">Access to virtual functions</a></li>
        <li><a href="#access-control-with-multiple-inheritance">Access control with multiple inheritance</a></li>
      </ul>
    </li>
  </ul>
</nav>
                
                <p>在C++中关于类内成员的访问控制的一些简单的介绍。</p>
<p>[toc]</p>
<h1 id="c类中的成员访问控制">C++类中的成员访问控制</h1>
<h2 id="access-control-in-derived-classes">Access Control in Derived Classes</h2>
<p>Two factors control which members of a base class are accessible in a derived class; these same factors control access to the inherited members in the derived class:</p>
<ul>
<li>Whether the derived class declares the base class using the <strong>public</strong> access specifier.</li>
<li>What the access to the member is in the base class.</li>
</ul>
<p>The following table shows the interaction between these factors and how to determine base-class member access.</p>
<h3 id="member-access-in-base-class">Member Access in Base Class</h3>
<table>
<thead>
<tr>
<th style="text-align:left">private</th>
<th style="text-align:left">protected</th>
<th style="text-align:left">Public</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left">Always inaccessible regardless of derivation access</td>
<td style="text-align:left">Private in derived class if you use private derivation</td>
<td style="text-align:left">Private in derived class if you use private derivation</td>
</tr>
<tr>
<td style="text-align:left"></td>
<td style="text-align:left">Protected in derived class if you use protected derivation</td>
<td style="text-align:left">Protected in derived class if you use protected derivation</td>
</tr>
<tr>
<td style="text-align:left"></td>
<td style="text-align:left">Protected in derived class if you use public derivation</td>
<td style="text-align:left">Public in derived class if you use public derivation</td>
</tr>
</tbody>
</table>
<h2 id="access-control-and-static-members">Access control and static members</h2>
<p>When you specify a base class as <strong>private</strong>, it affects only nonstatic members. Public static members are still accessible in the derived classes. However, accessing members of the base class using pointers, references, or objects can require a conversion, at which time access control is again applied. Consider the following example:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-cpp" data-lang="cpp"><span style="color:#6272a4">// access_control.cpp
</span><span style="color:#6272a4"></span><span style="color:#ff79c6">class</span> <span style="color:#50fa7b">Base</span>
{
<span style="color:#ff79c6">public</span><span style="color:#ff79c6">:</span>
    <span style="color:#8be9fd">int</span> Print();             <span style="color:#6272a4">// Nonstatic member.
</span><span style="color:#6272a4"></span>    <span style="color:#ff79c6">static</span> <span style="color:#8be9fd">int</span> <span style="color:#50fa7b">CountOf</span>();    <span style="color:#6272a4">// Static member.
</span><span style="color:#6272a4"></span>};

<span style="color:#6272a4">// Derived1 declares Base as a private base class.
</span><span style="color:#6272a4"></span><span style="color:#ff79c6">class</span> <span style="color:#50fa7b">Derived1</span> <span style="color:#ff79c6">:</span> <span style="color:#ff79c6">private</span> Base
{
};
<span style="color:#6272a4">// Derived2 declares Derived1 as a public base class.
</span><span style="color:#6272a4"></span><span style="color:#ff79c6">class</span> <span style="color:#50fa7b">Derived2</span> <span style="color:#ff79c6">:</span> <span style="color:#ff79c6">public</span> Derived1
{
    <span style="color:#8be9fd">int</span> <span style="color:#50fa7b">ShowCount</span>();    <span style="color:#6272a4">// Nonstatic member.
</span><span style="color:#6272a4"></span>};
<span style="color:#6272a4">// Define ShowCount function for Derived2.
</span><span style="color:#6272a4"></span><span style="color:#8be9fd">int</span> Derived2<span style="color:#ff79c6">::</span>ShowCount()
{
   <span style="color:#6272a4">// Call static member function CountOf explicitly.
</span><span style="color:#6272a4"></span>    <span style="color:#8be9fd">int</span> cCount <span style="color:#ff79c6">=</span> Base<span style="color:#ff79c6">::</span>CountOf();     <span style="color:#6272a4">// OK. //PS：自己测试的时候发现此处报错。
</span><span style="color:#6272a4"></span>    <span style="color:#6272a4">// kyen : error C2247: &#39;Base::CountOf&#39; not accessible because &#39;Derived1&#39; uses &#39;private&#39; to inherit from &#39;Base&#39;
</span><span style="color:#6272a4"></span>
   <span style="color:#6272a4">// Call static member function CountOf using pointer.
</span><span style="color:#6272a4"></span>    cCount <span style="color:#ff79c6">=</span> <span style="color:#ff79c6">this</span><span style="color:#ff79c6">-&gt;</span>CountOf();  <span style="color:#6272a4">// C2247. Conversion of
</span><span style="color:#6272a4"></span>                               <span style="color:#6272a4">//  Derived2 * to Base * not
</span><span style="color:#6272a4"></span>                               <span style="color:#6272a4">//  permitted.
</span><span style="color:#6272a4"></span>    <span style="color:#6272a4">// kyen : error C2247: &#39;Base::CountOf&#39; not accessible because &#39;Derived1&#39; uses &#39;private&#39; to inherit from &#39;Base&#39;
</span><span style="color:#6272a4"></span>    <span style="color:#ff79c6">return</span> cCount;
}
</code></pre></div><p>In the preceding code, access control prohibits conversion from a pointer to <code>Derived2</code> to a pointer to <code>Base</code>. The <strong>this</strong> pointer is implicitly of type <code>Derived2 *</code>. To select the <code>CountOf</code> function, <strong>this</strong> must be converted to type <code>Base *</code>. Such a conversion is not permitted because <code>Base</code> is a private indirect base class to <code>Derived2</code>. Conversion to a private base class type is acceptable only for pointers to immediate derived classes. Therefore, pointers of type <code>Derived1 *</code> can be converted to type <code>Base *</code>.</p>
<p>Note that calling the <code>CountOf</code> function explicitly, without using a pointer, reference, or object to select it, implies no conversion. Therefore, the call is allowed.</p>
<p>Members and friends of a derived class, <code>T</code>, can convert a pointer to <code>T</code> to a pointer to a private direct base class of <code>T</code>.</p>
<h2 id="access-to-virtual-functions">Access to virtual functions</h2>
<p>The access control applied to <a href="https://docs.microsoft.com/en-us/cpp/cpp/virtual-cpp?view=vs-2019">virtual</a> functions is determined by the type used to make the function call. Overriding declarations of the function do not affect the access control for a given type. For example:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-cpp" data-lang="cpp"><span style="color:#6272a4">// access_to_virtual_functions.cpp
</span><span style="color:#6272a4"></span><span style="color:#ff79c6">class</span> <span style="color:#50fa7b">VFuncBase</span>
{
<span style="color:#ff79c6">public</span><span style="color:#ff79c6">:</span>
    <span style="color:#ff79c6">virtual</span> <span style="color:#8be9fd">int</span> GetState() { <span style="color:#ff79c6">return</span> _state; }
<span style="color:#ff79c6">protected</span><span style="color:#ff79c6">:</span>
    <span style="color:#8be9fd">int</span> _state;
};

<span style="color:#ff79c6">class</span> <span style="color:#50fa7b">VFuncDerived</span> <span style="color:#ff79c6">:</span> <span style="color:#ff79c6">public</span> VFuncBase
{
<span style="color:#ff79c6">private</span><span style="color:#ff79c6">:</span>
    <span style="color:#8be9fd">int</span> GetState() { <span style="color:#ff79c6">return</span> _state; }
};

<span style="color:#8be9fd">int</span> <span style="color:#50fa7b">main</span>()
{
   VFuncDerived vfd;             <span style="color:#6272a4">// Object of derived type.
</span><span style="color:#6272a4"></span>   VFuncBase <span style="color:#ff79c6">*</span>pvfb <span style="color:#ff79c6">=</span> <span style="color:#ff79c6">&amp;</span>vfd;       <span style="color:#6272a4">// Pointer to base type.
</span><span style="color:#6272a4"></span>   VFuncDerived <span style="color:#ff79c6">*</span>pvfd <span style="color:#ff79c6">=</span> <span style="color:#ff79c6">&amp;</span>vfd;    <span style="color:#6272a4">// Pointer to derived type.
</span><span style="color:#6272a4"></span>   <span style="color:#8be9fd">int</span> State;

   State <span style="color:#ff79c6">=</span> pvfb<span style="color:#ff79c6">-&gt;</span>GetState();     <span style="color:#6272a4">// GetState is public.
</span><span style="color:#6272a4"></span>   State <span style="color:#ff79c6">=</span> pvfd<span style="color:#ff79c6">-&gt;</span>GetState();     <span style="color:#6272a4">// C2248 error expected; GetState is private;
</span><span style="color:#6272a4"></span>}
</code></pre></div><p>In the preceding example, calling the virtual function <code>GetState</code> using a pointer to type <code>VFuncBase</code> calls <code>VFuncDerived::GetState</code>, and <code>GetState</code> is treated as public. However, calling <code>GetState</code> using a pointer to type <code>VFuncDerived</code> is an access-control violation because <code>GetState</code> is declared private in class <code>VFuncDerived</code>.</p>
<p><strong>Caution</strong></p>
<p>The virtual function <code>GetState</code> can be called using a pointer to the base class <code>VFuncBase</code>. This does not mean that the function called is the base-class version of that function.</p>
<h2 id="access-control-with-multiple-inheritance">Access control with multiple inheritance</h2>
<p>In multiple-inheritance lattices involving virtual base classes, a given name can be reached through more than one path. Because different access control can be applied along these different paths, the compiler chooses the path that gives the most access. See the following figure.</p>
<p>
  <img src="https://docs.microsoft.com/en-us/cpp/cpp/media/vc38v91.gif?view=vs-2019" alt="Access along paths of an inheritance graph">

</p>
<p>Access along paths of an inheritance graph</p>
<p>In the figure, a name declared in class <code>VBase</code> is always reached through class <code>RightPath</code>. The right path is more accessible because <code>RightPath</code> declares <code>VBase</code> as a public base class, whereas <code>LeftPath</code> declares <code>VBase</code> as private.</p>

                

                <hr>
                <ul class="pager">
                    
                    <li class="previous">
                        <a href="/post/c&#43;&#43;%E4%B8%AD%E6%9E%84%E5%BB%BA%E5%AD%97%E7%AC%A6%E4%B8%B2%E7%9A%84%E5%AE%8C%E5%85%A8%E6%8C%87%E5%8D%97/" data-toggle="tooltip" data-placement="top" title="C&#43;&#43;中构建字符串的完全指南">&larr;
                            Previous Post</a>
                    </li>
                    
                    
                    <li class="next">
                        <a href="/post/c&#43;&#43;%E4%B8%AD%E9%A2%84%E5%A4%84%E7%90%86%E5%99%A8%E8%BF%90%E7%AE%97%E7%AC%A6/" data-toggle="tooltip" data-placement="top" title="C&#43;&#43;中预处理器运算符">Next
                            Post &rarr;</a>
                    </li>
                    
                </ul>

                
<div id="disqus-comment"></div>



            </div>
            
            <div class="
                col-lg-11 col-lg-offset-1
                col-md-10 col-md-offset-1
                sidebar-container">

                
                

                
                
            </div>
        </div>
    </div>
</article>




<footer>
    <div class="container">
        <div class="row">
            <div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1">
                <ul class="list-inline text-center">
                    
                    <li>
                        <a href='' rel="alternate"
                            type="application/rss+xml" title="Huimin Blog">
                            <span class="fa-stack fa-lg">
                                <i class="fas fa-circle fa-stack-2x"></i>
                                <i class="fas fa-rss fa-stack-1x fa-inverse"></i>
                            </span>
                        </a>
                    </li>
                    
                    
                    <li>
                        <a href="mailto:huimin.liang.chn@gmail.com">
                            <span class="fa-stack fa-lg">
                                <i class="fas fa-circle fa-stack-2x"></i>
                                <i class="fas fa-envelope fa-stack-1x fa-inverse"></i>
                            </span>
                        </a>
                    </li>
                    

                    
                    
                    

                    

                    
                    
                    
                    
                    
                    
                    
                    
                    
                    
                    
                    
                    
                    
                </ul>
                <p class="copyright text-muted">
                    Copyright &copy; Huimin Blog 2021
                    
                    |
                    
                    <img src="/img/beian.png">
                    <a href="https://beian.miit.gov.cn/">京ICP备18062069号</a>
                </p>
            </div>
        </div>
    </div>
</footer>




<script>
    function loadAsync(u, c) {
        var d = document, t = 'script',
            o = d.createElement(t),
            s = d.getElementsByTagName(t)[0];
        o.src = u;
        if (c) { o.addEventListener('load', function (e) { c(null, e); }, false); }
        s.parentNode.insertBefore(o, s);
    }
</script>






<script>
    
    if ($('#tag_cloud').length !== 0) {
        loadAsync("/js/jquery.tagcloud.js", function () {
            $.fn.tagcloud.defaults = {
                
                color: { start: '#bbbbee', end: '#0085a1' },
            };
            $('#tag_cloud a').tagcloud();
        })
    }
</script>


<script>
    loadAsync("https://cdnjs.cloudflare.com/ajax/libs/fastclick/1.0.6/fastclick.js", function () {
        var $nav = document.querySelector("nav");
        if ($nav) FastClick.attach($nav);
    })
</script>





</body>
</html>
